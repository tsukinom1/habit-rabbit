generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String?
  role      Role     @default(USER)
  profile   Profile? // –°–≤—è–∑—å –æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É —Å –ø—Ä–æ—Ñ–∏–ª–µ–º
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("users")
}

model Profile {
  id     String @id @default(cuid())
  userId String @unique // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π, —á—Ç–æ–±—ã –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–∏–Ω –ø—Ä–æ—Ñ–∏–ª—å
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  firstName String    @map("first_name")
  lastName  String    @map("last_name")
  avatar    String?   @default("/icons/default-avatar.png")
  bio       String // –î–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
  gender    String?
  birthDate DateTime? @map("birth_date")
  phone     String?

  // –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
  country String?
  city    String?
  address String?

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
  isPublic Boolean @default(true) @map("is_public") // –ü—É–±–ª–∏—á–Ω—ã–π/–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
  timezone String? @default("UTC") // –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  language String? @default("ru") // –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π —è–∑—ã–∫

  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–±—É–¥–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
  totalHabits     Int @default(0) @map("total_habits")
  completedHabits Int @default(0) @map("completed_habits")
  currentStreak   Int @default(0) @map("current_streak")
  longestStreak   Int @default(0) @map("longest_streak")

  // –°–≤—è–∑–∏
  habits  Habit[]
  socials Social[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("profiles")
}

model Social {
  id        String  @id @default(cuid())
  profileId String  @map("profile_id")
  profile   Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  platform SocialType // –¢–∏–ø —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
  url      String // –°—Å—ã–ª–∫–∞
  username String? // Username (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  isPublic Boolean    @default(true) @map("is_public")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("socials")
}

model Habit {
  id        String  @id @default(cuid())
  profileId String  @map("profile_id")
  profile   Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–≤—ã—á–∫–µ
  title       String
  description String?
  icon        String? @default("üéØ") // –≠–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∞
  color       String? @default("#3B82F6") // –¶–≤–µ—Ç –¥–ª—è UI

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤—ã—á–∫–∏
  frequency   Frequency @default(DAILY) // –ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  targetValue Int?      @map("target_value") // –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 –æ—Ç–∂–∏–º–∞–Ω–∏–π)
  unit        String? // –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è (—Ä–∞–∑, –º–∏–Ω—É—Ç, –∫–º –∏ —Ç.–¥.)

  // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  reminderTime String?   @map("reminder_time") // –í—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM
  startDate    DateTime  @default(now()) @map("start_date")
  endDate      DateTime? @map("end_date") // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫

  // –°—Ç–∞—Ç—É—Å
  isActive   Boolean @default(true) @map("is_active")
  isArchived Boolean @default(false) @map("is_archived")

  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  currentStreak Int @default(0) @map("current_streak")
  longestStreak Int @default(0) @map("longest_streak")
  totalEntries  Int @default(0) @map("total_entries")

  // –°–≤—è–∑–∏
  entries HabitEntry[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("habits")
}

model HabitEntry {
  id      String @id @default(cuid())
  habitId String @map("habit_id")
  habit   Habit  @relation(fields: [habitId], references: [id], onDelete: Cascade)

  // –î–∞–Ω–Ω—ã–µ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏
  date  DateTime // –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  value Int? // –ó–Ω–∞—á–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø—Ä–∏–≤—ã—á–∫–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º)
  note  String? // –ó–∞–º–µ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  mood  Mood? // –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏

  // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@unique([habitId, date]) // –û–¥–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–∞ –ø—Ä–∏–≤—ã—á–∫—É –≤ –¥–µ–Ω—å
  @@map("habit_entries")
}

enum Role {
  USER
  ADMIN
}

enum SocialType {
  TELEGRAM
  VK
  INSTAGRAM
  TWITTER
  YOUTUBE
  LINKEDIN
  GITHUB
  WEBSITE
  OTHER
}

enum Frequency {
  DAILY // –ï–∂–µ–¥–Ω–µ–≤–Ω–æ
  WEEKLY // –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ  
  MONTHLY // –ï–∂–µ–º–µ—Å—è—á–Ω–æ
  CUSTOM // –ö–∞—Å—Ç–æ–º–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞
}

enum Mood {
  TERRIBLE // üòû
  BAD // üòî  
  NEUTRAL // üòê
  GOOD // üôÇ
  EXCELLENT // üòÉ
}
